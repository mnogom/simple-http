install_path='/tmp/';echo '#!/usr/bin/env python3\n\nimport socket\nimport argparse\n\nRESPONSE = """\\nHTTP/1.0 200 OK\n\nHELLO!\n""".encode()\n\n\ndef parse_args() -> tuple[str, int]:\n    parser = argparse.ArgumentParser()\n    parser.add_argument("-H", "--host", type=str, default="127.0.0.1")\n    parser.add_argument("-p", "--port", type=int, default=8000)\n    args = parser.parse_args()\n    return args.host, args.port\n\n\ndef main() -> None:\n    host, port = parse_args()\n\n    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM, proto=0)\n    sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\n    sock.bind((host, port))\n    sock.listen(1)\n    print("Listening port %s" % port)\n    try:\n        while True:\n            connection, address = sock.accept()\n            print("Connection from %s" % str(address))\n            # response = connection.recv(1024).decode()\n            connection.sendall(RESPONSE)\n            connection.close()\n    except:\n        raise\n    finally:\n        sock.close()\n\n\nif __name__ == "__main__":\n    main()' > $install_path/main.py;echo '#!/bin/bash -e\n\nscript_dir=$(dirname "$0")\n\nHOST="localhost"\nPORT="8000"\n\nrun() {\n	"$script_dir"/main.py -p "$PORT" -H "$HOST"\n}\n\nrun_daemon() {\n	"$script_dir"/main.py -p "$PORT" -H "$HOST" &\n	pid=$!\n	echo "Run daemon with pid: $pid"\n	echo "$pid" >/tmp/.socket.daemon.pid\n}\n\nkill_daemon() {\n	pid=$(cat /tmp/.socket.daemon.pid)\n	kill -9 "$pid"\n	wait $!\n	rm /tmp/.socket.daemon.pid\n}\n\nping() {\n	curl http://localhost:8000\n}\n\ncase $1 in\n"run" | "r")\n	run\n	;;\n"run_daemon" | "rd")\n	run_daemon\n	;;\n"kill" | "k")\n	kill_daemon\n	;;\n"ping" | "p")\n	ping\n	;;\n*)\n	echo "Unknown command: $1"\n	exit 1\n	;;\nesac' > $install_path/manage.sh;chmod +x $install_path/manage.sh $install_path/main.py;